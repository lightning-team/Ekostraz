<mat-card
  *ngIf="intervention"
  [withGtmContext]="interventionDetailsGtmContext"
  [ngClass]="{ 'mat-elevation-z4': !embedded, embedded: !!embedded }"
>
  <div class="title-wrapper">
    <mat-card-title>Zgłoszenie z dnia {{ intervention.creationDate | date: 'medium' }}</mat-card-title>
    <mat-card-subtitle>Identyfikator zgłoszenia: {{ intervention.id }}</mat-card-subtitle>
  </div>

  <mat-card-actions align="end">
    <button mat-raised-button color="primary" title="Edytuj" (click)="navigateToEditView()">
      {{ embedded ? '' : 'Edytuj' }}<mat-icon>edit</mat-icon>
    </button>
    <!-- TODO: "Delete" button is disabled until confirmed that we still need it -->
    <button *ngIf="false" mat-raised-button color="warn" title="Usuń" (click)="showDeleteDialog()">
      {{ embedded ? '' : 'Usuń' }}<mat-icon>delete</mat-icon>
    </button>
  </mat-card-actions>

  <mat-list>
    <mat-list-item> <mat-icon>done</mat-icon> {{ intervention.status | ekoInterventionStatus }} </mat-list-item>
    <mat-list-item> <mat-icon>account_circle</mat-icon> {{ intervention.fullName }} </mat-list-item>
    <mat-list-item> <mat-icon>phone</mat-icon> {{ intervention.phoneNumber }} </mat-list-item>
    <mat-list-item> <mat-icon>email</mat-icon> {{ intervention.email }} </mat-list-item>
    <mat-list-item> <mat-icon>location_on</mat-icon> {{ intervention.address }} </mat-list-item>
  </mat-list>

  <mat-card-content>
    {{ intervention.description }}

    <section *ngIf="!embedded" class="map-container">
      <agm-map [latitude]="intervention.geoLat" [longitude]="intervention.geoLng">
        <agm-marker [latitude]="intervention.geoLat" [longitude]="intervention.geoLng"> </agm-marker>
      </agm-map>
    </section>
  </mat-card-content>
  <div>
    <div *ngFor="let comment of intervention.comments">
      <div class="comment">
        <div class="comment-box">
          <div class="comment-text">{{ comment.comment }}</div>
          <div class="comment-footer">
            <div class="comment-info">
              <span class="comment-author">
                <em>Anonymous</em>
              </span>
              <span class="comment-date">{{ comment.createdDate | date: 'medium' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="comment-form">
      <form [formGroup]="form" (ngSubmit)="addComment()" class="form" novalidate>
        <div class="form-row">
          <textarea class="input" formControlName="comment" placeholder="Add comment..." required></textarea>
        </div>
        <div class="form-row">
          <input type="submit" value="Add Comment" [disabled]="!form.valid" />
        </div>
      </form>
    </div>
  </div>
</mat-card>
