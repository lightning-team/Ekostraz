<mat-sidenav-container>
  <mat-sidenav #sidenav [autoFocus]="false">
    <mat-nav-list [withGtmContext]="mobileNavGtmContext">
      <ng-container *ngIf="isLoggedIn$ | async">
        <mat-list-item>Witaj, {{ (user$ | async)?.name }}!</mat-list-item>
        <mat-divider></mat-divider>
      </ng-container>

      <ul class="nav-links-list">
        <ng-container *ngFor="let item of menuItems.navigationLinks">
          <li *ngIf="item.showWhenAuthenticated === (isLoggedIn$ | async)">
            <ng-container *ngTemplateOutlet="navAnchor; context: { item: item }"></ng-container>
          </li>
        </ng-container>
      </ul>

      <mat-divider></mat-divider>

      <ng-container *ngTemplateOutlet="authLinks"></ng-container>
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content>
    <ng-content></ng-content>
  </mat-sidenav-content>
</mat-sidenav-container>

<ng-template #navAnchor let-item="item">
  <a
    mat-list-item
    (click)="sidenav.close()"
    [routerLink]="item.routeLink"
    [routerLinkActiveOptions]="{ exact: !!item.routeExact }"
    routerLinkActive="active"
  >
    <mat-icon matListIcon *ngIf="!!item.icon"> {{ item.icon }} </mat-icon>
    {{ item.text }}
  </a>
</ng-template>

<ng-template #authLinks>
  <ng-container *ngIf="(isLoggedIn$ | async) === false && menuItems.logIn as item">
    <a mat-list-item rel="noreferrer noopener nofollow" href="{{ loginLink }}" title="{{ item.title }}">
      <mat-icon matListIcon> {{ item.icon }} </mat-icon>
      {{ item.text }}
    </a>
  </ng-container>

  <ng-container *ngIf="(isLoggedIn$ | async) && menuItems.logOut as item">
    <a mat-list-item rel="noreferrer noopener nofollow" href="{{ logoutLink }}" title="{{ item.title }}">
      <mat-icon matListIcon>{{ item.icon }}</mat-icon>
      {{ item.text }}
    </a>
  </ng-container>
</ng-template>
